<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <script>
        targets = {};
        targets['https://soku-cn.gitee.io'] = 'iframe1';
        targets['https://wiki-github.514.live'] = 'iframe2';
        targets['https://hisoutensoku-cn-wiki.vercel.app'] = 'iframe3';
        usedTarget = ""
        funs = {
            path: (path) => {
                history.replaceState(null, "", path)
            },
            title: (title) => { document.title = title; }
        };
        window.addEventListener("message", (event) => {
            // if (! ["local"].includes(event.host)) return;
            // console.log("event!", event, event.data);
            if (!usedTarget) {
                for (var k in targets) {
                    if (k != event.origin) continue;
                    console.log("use ", k);
                    for (var k_ in targets) {
                        if (k_ == k) continue;
                        console.log("remove ", k_);
                        iframe = document.getElementById(targets[k_]);
                        if (iframe)
                            iframe.remove();
                        else
                            console.warn("cannot find ", targets[k_]);
                    }
                    usedTarget = k;
                    break;
                }
            }
            (funs[event.data[0]])(event.data[1]);
        });
    </script>
</head>

<body style="margin:0px;padding:0px;overflow:hidden">
    <!-- <script>
        function changeFrameHeight() {
            var iframe = document.getElementById("iframe");
            iframe.height = document.documentElement.clientHeight;
        }
    </script> -->
    <iframe id="iframe1" height="100%" width="100%"
        style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px;z-index:1;"
        seamless="seamless" frameborder="0" marginwidth="0" marginheight="0"></iframe>
    <iframe id="iframe2" height="100%" width="100%"
        style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px;z-index:2;"
        seamless="seamless" frameborder="0" marginwidth="0" marginheight="0"></iframe>
    <iframe id="iframe3" height="100%" width="100%"
        style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px;z-index:3;"
        seamless="seamless" frameborder="0" marginwidth="0" marginheight="0"></iframe>
    <script>
        for (var k in targets){
            iframe = document.getElementById(targets[k]);
            iframe.setAttribute("src", k + window.location.href.substr(window.location.origin.length));
        }
    </script>
</body>

</html>
